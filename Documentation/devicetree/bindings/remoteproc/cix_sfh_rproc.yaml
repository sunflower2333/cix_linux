# SPDX-License-Identifier: (GPL-2.0 OR BSD-2-Clause)
%YAML 1.2
---
$id: "http://devicetree.org/schemas/remoteproc/cix_sfh_rproc.yaml#"
$schema: "http://devicetree.org/meta-schemas/core.yaml#"

title: Cix SFH Remoteproc Driver bindings

maintainers:
  - Lihua Liu <Lihua.Liu@cixcomputing.com>

description:
  CIX Sensor Fusion Hub remoteproc driver is used to control sensorHub
  M33 core, such as start, stop and boot sensorhub mcu. Mailbox will be
  used for msg exchange between AP and sensorhub mcu. In additional,
  crash dump and recovery are supported with this driver when remote
  processor crash happen.

properties:
  compatible:
    const: cix,sky1-sfh

  reg:
    maxItems: 1

  interrupts:
    description: Should contain the watchdog reset interrupt
    maxItems: 1

  "#mbox-cells":
    description: |
      <&phandle channel>
      phandle   : Label name of controller
      channel   : Channel index

      channel 0_7 - Fast channel with 32bit transmit register and IRQ support.
      channel 8   - Reg based channel with 32*32bit transsmit register and
                    Doorbell+transmit acknowledgment IRQ support
      channel 9   - Fifo based channel with 32*32bit depth fifo and IRQ support.
    const: 1

  firmware-name:
    description: Default name of the firmware to load to the remote processor.

  memory-region:
    description:
      List of phandles to the reserved memory regions associated with the
      remoteproc device. It describes the memories shared with
      the remote processor (e.g. remoteproc firmware and carveouts, rpmsg
      vrings, ...).

  wakeup-source: true

required:
  - compatible
  - reg
  - interrupts
  - "#mbox-cells"
  - "firmware-name"
  - "memroy-region"
  - "wakeup-source"

additionalProperties: false

examples:
  - |
    #include <dt-bindings/interrupt-controller/arm-gic.h>

    sensor-mcu {
      compatible = "cix,sky1-sfh";
      reg = <0x0 0x30000000 0x0 0x100000>;
      interrupts = <GIC_SPI 88 IRQ_TYPE_LEVEL_HIGH>;
      firmware-name = "cix/sfh_fw.bin";
      mbox-names = "tx1", "rx1";
      mboxes = <&mbox2 0>,	/* index=0: Fast channel */
        <&mbox3 0>;
      memory-region = <&mcu_vdev0buffer>, <&mcu_vdev0vring0>,
          <&mcu_vdev0vring1>, <&mcu_ram>;
      wakeup-source;
    };

    /* Reserve memory node */
    mcu_vdev0buffer: vdev0buffer@40008000 {	/* 1M for tx/rx buffer */
      compatible = "shared-dma-pool";
      reg = <0x0 0x40008000 0x0 0x100000>;
      no-map;
    };
